name: 'Test Vagrant Environment'

on:
  push:
    branches:
      - main

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: 🔍 Check out repository
        uses: actions/checkout@v3

      - name: 📦 Update apt
        run: sudo apt-get update -y

      - name: 📦 Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.10

      - name: 🐍 Install Vagrant
        run: |
          wget https://releases.hashicorp.com/vagrant/2.3.7/vagrant_2.3.7_x86_64.deb
          sudo dpkg -i vagrant_2.3.7_x86_64.deb
          rm vagrant_2.3.7_x86_64.deb

      - name: 📦 Install VirtualBox
        run: |
          sudo apt-get install -y virtualbox

      - name: 🚀 Run Vagrant
        run: |
          vagrant up
          vagrant ssh -c "echo 'Vagrant environment is up and running!'"
          vagrant destroy -f
